.. _Tripeptide Database:

ðŸ—ƒ Tripeptide Database
======================

Ensemblify provides a three-residue fragment (tripeptide) database from which to sample dihedral angles, found here `link <https://example.com>`_.

This database was originally created and published by GonzÃ¡lez-Delgado *et al.* and, as described in [9]_, it was built by extracting dihedral angles from structures taken from the SCOPe [10]_ [11]_ 2.07 release, a curated database of high-resolution experimentally determined protein structures.
In total, 6,740,433 tripeptide dihedral angle values were extracted, making up the *all* dataset. A structurally filtered dataset, *coil*, was generated by removing tripeptides contained in Î±-helices or Î²-strands, reducing the number of tripeptide dihedral angle values to 3,141,877.

Using your own database
-----------------------

Ensemblify can sample dihedral angles from any file in a supported format (currently .parquet, .pkl or .csv), structured according to `Database Structure`_. Tripeptide sampling mode will only work if a tripeptide database is provided. However, single residue sampling mode will work even when you provide a tripeptide database.

Database Structure
------------------

Tripeptide Database
^^^^^^^^^^^^^^^^^^^

Your database must contain at least 10 columns: 9 containing the Phi, Psi and Omega angles for each residue of the triplet (**in radians**) and 1 with the string identification of the fragment they make up. Any additional columns will be ignored.

+------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
| FRAG |  OMG1  |  PHI1  |  PSI1  |  OMG2  |  PHI2  |  PSI2  |  OMG3  |  PHI3  |  PSI3  |
+======+========+========+========+========+========+========+========+========+========+
| AAA  | 3.1364 | -1.696 | 1.1003 | -3.140 | -2.765 | 2.6750 | 3.1406 | -2.006 | 2.0631 |
+------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
| ...  |   ...  |   ...  |   ...  |   ...  |   ...  |   ...  |   ...  |   ...  |   ...  |
+------+--------+--------+--------+--------+--------+--------+--------+--------+--------+
| VYV  | -3.135 | -2.503 | -0.949 | -3.119 | 1.4074 | 1.9791 | -3.112 | -2.592 | 2.5737 |
+------+--------+--------+--------+--------+--------+--------+--------+--------+--------+

Single Residue Database
^^^^^^^^^^^^^^^^^^^^^^^

Your database must contain at least 4 columns: 3 containing the Phi, Psi and Omega angles for each residue (**in radians**) and 1 with the string identification of the residue. Any additional columns will be ignored. Note the '2' suffix in the column names which help with compatibility between single residue and tripeptide sampling modes.

+------+--------+--------+--------+
| FRAG |  OMG2  |  PHI2  |  PSI2  |
+======+========+========+========+
|  A   | -3.140 | -2.765 | 2.6750 |
+------+--------+--------+--------+
| ...  |   ...  |   ...  |   ...  |
+------+--------+--------+--------+
|  Y   | -3.119 | 1.4074 | 1.9791 |
+------+--------+--------+--------+ 

References
----------

.. [9] J. GonzÃ¡lez-Delgado , P. BernadÃ³ , P. Neuvial and J. CortÃ©s, "Statistical proofs of the interdependence between nearest neighbor effects on polypeptide backbone conformations," *Journal of Structural Biology*, vol. 214, no. 4, p. 107907, Dec. 2022 `Link <https://doi.org/10.1016/j.jsb.2022.107907>`_

.. [10] N. K. Fox, S. E. Brenner and J. M. Chandonia, "SCOPe: Structural Classification of Proteinsâ€”extended, integrating SCOP and ASTRAL data and classification of new structures," *Nucleic Acids Research*, vol. 42, no. D1, pp. D304-D309, Jan. 2014 `Link <https://doi.org/10.1093/nar/gkt1240>`_

.. [11] J. M. Chandonia, N. K. Fox and S. E. Brenner, "SCOPe: classification of large macromolecular structures in the structural classification of proteinsâ€”extended database," *Nucleic Acids Research*, vol. 47, no. D1, pp. D475-D481, Jan. 2019 `Link <https://doi.org/10.1093/nar/gky1134>`_
